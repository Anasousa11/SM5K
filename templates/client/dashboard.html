{% extends "base.html" %}

{% block title %}Client Dashboard | SinMancha{% endblock %}

{% block content %}
<section class="page-header">
  <h1>Client Dashboard</h1>
  <p>Welcome back, {{ request.user.first_name|default:request.user.username }}.</p>
</section>

<section class="dashboard-grid">
  <div class="card">
    <h2>Your membership</h2>
    {% if membership %}
      <p><strong>{{ membership.plan.name }}</strong></p>
      <p>Billing: {{ membership.plan.get_billing_interval_display }}</p>
      <p>Ends: {{ membership.end_date }}</p>
      <p>Status:
        {% if membership.is_active %}
          <span class="membership-active">Active</span>
        {% else %}
          <span class="membership-expired">Expired</span>
        {% endif %}
      </p>
    {% else %}
      <p>You don’t have an active membership.</p>
      <a href="{% url 'membership_plans' %}" class="btn btn-primary">View plans</a>
    {% endif %}
  </div>

  <div class="card">
    <h2>Upcoming events from your coach</h2>
    {% if upcoming_events %}
      <ul style="padding-left:1rem;">
        {% for event in upcoming_events %}
          <li>
            {{ event.date }} · {{ event.start_time|time:"H:i" }} — {{ event.title }}
          </li>
        {% endfor %}
      </ul>
      <a href="{% url 'events' %}" class="btn btn-secondary" style="margin-top:0.5rem;">View all events</a>
    {% else %}
      <p>No upcoming events for your coach yet.</p>
    {% endif %}
  </div>

  <div class="card">
    <h2>My registrations</h2>
    {% if my_registrations %}
      <ul style="padding-left:1rem;">
        {% for reg in my_registrations|slice:":5" %}
          <li>
            {{ reg.event.date }} – {{ reg.event.title }}
            ({{ reg.get_status_display }})
          </li>
        {% endfor %}
      </ul>
      <a href="{% url 'my_events' %}" class="btn btn-secondary" style="margin-top:0.5rem;">View all</a>
    {% else %}
      <p>You haven’t booked any events yet.</p>
      <a href="{% url 'events' %}" class="btn btn-primary">Browse events</a>
    {% endif %}
  </div>
</section>
{% endblock %}
